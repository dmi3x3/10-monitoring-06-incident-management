# Домашнее задание к занятию "10.06. Инцидент-менеджмент"

## Задание 1

Составьте постмотрем, на основе реального сбоя системы Github в 2018 году.

Информация о сбое доступна [в виде краткой выжимки на русском языке](https://habr.com/ru/post/427301/) , а
также [развёрнуто на английском языке](https://github.blog/2018-10-30-oct21-post-incident-analysis/).

| Разделы                                                                                            | Описание                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|----------------------------------------------------------------------------------------------------|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Краткое описание инцидента (краткая выжимка о инциденте)                                           | 21 октября 2018 г. в 22:52 UTC в результате регламентных работ по замене вышедшего из строя оптического оборудования 100G была потеряна связь между нашим сетевым концентратором на восточном побережье США и нашим основным центром обработки данных на восточном побережье США. Связь между этими точками была восстановлена за 43 секунды, но этот кратковременный сбой вызвал цепочку событий, которые привели к ухудшению качества обслуживания на 24 часа 11 минут.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| Предшествующие события (что произошло перед инцидентом)                                            | 21 октября в 22:52 UTC производились регламентные работы по замене вышедшего из строя оптического оборудования 100G                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| Причина инцидента (из-за чего возник инцидент)                                                     | Потеря связи между сетевым концентратором (Github) на восточном побережье США и основным центром обработки данных (Github) на восточном побережье США.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| Воздействие (на что повлиял инцидент)                                                              | Инцидент повлиял только на метаданные веб-сайтов, хранящиеся в базах данных MySQL, такие как Issue и PR. Были приостановлены работа веб-перехватчиков и сборка GitHub Pages.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| Обнаружение (когда и как инцидент был обнаружен)                                                   | 2018 21 октября 22:54 UTC внутренние системы мониторинга начали генерировать предупреждения, указывающие на многочисленные сбои в системах. Инженеры группы быстрого реагирования определили, что топологии многочисленных кластеров баз данных находятся в непредвиденном состоянии.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| Реакция (кто ответил на инцидент, кто был привлечен, какие каналы коммуникации были задействованы) | Дежурная команда вручную заблокировала внутренний инструмент развертывания, чтобы предотвратить внесение каких-либо дополнительных изменений, также было частично ухудшено удобство использования сайта. Были привлечены: инженеры группы быстрого реагирования, координатор инцидента, инженеры из группы разработки.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| Восстановление (описание действий по устранению инцидента и поведение системы)                     | БД реплик на обоих сайтах были восстановлены из резервных копий и синхронизированы, после чего кластер был возвращен к стабильной топологии обслуживания (переключение на Primary сервер на восточном побережье), а затем возобновлена обработка заданий в очереди. Восстановление заняло 24 часа 11 минут.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| Таймлайн (последовательное описание ключевых событий инцидента с указанием времени)                | **21 октября в 22:52 UTC** Регламентные работы по замене вышедшего из строя оптического оборудования 100G<br/>**21 октября 22:52 UTC** Согласно консенсусу Raft сети Orchestrator начато аварийное переключение кластеров для направления операций записи в центр обработки данных на западном побережье США.<br/>**21 октября 22:54 UTC** Внутренние системы мониторинга начали генерировать предупреждения, указывающие на многочисленные сбои в наших системах.<br/>**21 октября 23:02 UTC** Инженеры группы быстрого реагирования определили, что топологии многочисленных кластеров баз данных находятся в непредвиденном состоянии.<br/>**21 октября 23:07 UTC** Отвечающая команда вручную заблокировала внутренний инструмент развертывания<br/>**21 октября 23:09 UTC** Команда респондентов поместила сайт в желтый статус<br/>**21 октября 23:11** Присоединился координатор инцидента и через две минуты изменил статус на красный.<br/>**21 октября 23:13 UTC** Стало понятно, что проблема затронула несколько кластеров баз данных. Были вызваны дополнительные инженеры из группы разработки баз данных GitHub.<br/>**21 октября 23:19 UTC** Остановлено выполнение заданий, записывающих метаданные о таких вещах, как push-уведомления, приостановлено выполнение веб-перехватчика и сборка GitHub Pages.<br/>**22 октября 00:05 UTC** Инженеры, начали разработку плана по устранению несоответствий данных и внедрению процедур аварийного переключения для MySQL,  обновилен статус, чтобы проинформировать пользователей о контролируемом переходе на другой узел кластера<br/>**22 октября 00:41 UTC** Инициирован процесс резервного копирования для всех затронутых кластеров MySQL.<br/>**22 октября 06:51 UTC** Несколько кластеров завершили восстановление из резервных копий в ЦОД на востоке США и начали репликацию новых данных с запада.<br/>**22 октября 07:46 UTC** GitHub опубликовал сообщение в блоге , чтобы предоставить больше информации.<br/>**22 октября 11:12 UTC** Все первичные базы данных снова установлены на восточном побережье США.<br/>**22 октября 13:15 UTC** Cтали доступны, дополнительные реплики чтения MySQL в общедоступном облаке восточного побережья США.<br/>**22 октября 16:24 UTC** Реплики синхронизированы, выполнено аварийное переключение на исходную топологию.<br/>**22 октября 16:45 UTC** Повторно включена обработка очереди из более пяти миллионов событий ловушек и 80 тысяч сборок страниц.<br/>**22 октября 23:03 UTC** Все ожидающие сборки вебхуков и страниц обработаны, и подтверждена целостность и правильная работа всех систем. Статус сайта обновлен до зеленого. |
| Последующие действия (что нужно предпринять, чтобы инцидент не повторялся)                         | **Выявлен ряд технических инициатив**:<br/>1. Настройка конфигурации Orchestrator, чтобы предотвратить продвижение основных баз данных через региональные границы.<br/>2. Ускорен переход на новый механизм отчетов о состоянии, который предоставит более богатый форум для обсуждения активных инцидентов более четким и понятным языком.<br/>3. За несколько недель до этого инцидента начата общекорпоративная инженерная инициатива по поддержке обслуживания трафика GitHub из нескольких центров обработки данных в схеме «активный/активный/активный». Целью этого проекта является поддержка резервирования N+1 на уровне объекта. Цель этой работы — допустить полный отказ одного центра обработки данных без воздействия на пользователя. Этот инцидент добавил актуальности инициативе.<br/>4. Требуется занять более активную позицию в проверке наших предположений.<br/>**Организационные инициативы**<br/>Этот инцидент изменил отношение к надежности сайта. Оказалось, что более строгий операционный контроль или сокращение времени отклика не являются достаточными гарантиями надежности сайта в рамках такой сложной системы служб, как Github. Для поддержки этих усилий, требуется начать системную практику проверки сценариев сбоев, прежде чем они смогут повлиять на пользователей. Эта работа потребует будущих инвестиций в инструменты внедрения ошибок и хаос-инжиниринга в GitHub.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |








---

### Как оформить ДЗ?

Выполненное домашнее задание пришлите ссылкой на .md-файл в вашем репозитории.

---
